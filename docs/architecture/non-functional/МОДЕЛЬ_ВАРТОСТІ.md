---
tags:
  - domain:arch
  - status:canonical
  - format:spec
  - feature:execution
created: 2026-02-22
updated: 2026-02-22
tier: 1
title: "МОДЕЛЬ ВАРТОСТІ"
dg-publish: true
dg-metatags:
dg-home:
---

# МОДЕЛЬ_ВАРТОСТІ

> Створено: 2026-02-22
> Автор: Головний архітектор системи
> Статус: Канонічна специфікація
> Мова: Українська (канонічна)

---

## КОНТЕКСТ

Garden Bloom проєктується як **cost-effective personal knowledge platform**. Архітектурні рішення (self-hosted MinIO, Cloudflare free tier, vendor-agnostic orchestration) є частково мотивовані cost considerations. Цей документ фіксує поточну модель вартості та допустимі cost ceilings для прийняття архітектурних рішень.

---

## ПРОБЛЕМА

Відсутність cost model призводить до:
- Відсутності basis для вибору між hosting options (self-hosted vs cloud)
- Непрозорості вартості при збільшенні кількості агентів та runs
- Ризику vendor lock-in дорогих сервісів

---

## РІШЕННЯ

### Поточна модель вартості (baseline)

| Компонент | Тип | Вартість/міс | Примітки |
|-----------|-----|-------------|----------|
| Cloudflare Worker | Managed | $0 (free tier: 100K req/day) | Потребує Paid при > 100K req |
| Cloudflare KV | Managed | $0–$5 | 100K reads/day free; 1K writes/day free |
| MinIO (self-hosted) | Self-managed | $0 (сервер вже є) | Cost = electricity + hardware amortization |
| git monorepo (GitHub) | Managed | $0 (public або private free) | — |
| Hatchet (Orchestration) | OSS self-hosted | $0 (сервер) | Або managed: $25+/міс |
| Mastra (Agent Service) | OSS self-hosted | Hosting cost | Railway: ~$5–20/міс |
| FastAPI (NLM proxy) | Self-hosted | $0 (Replit Always-On) або $5–20/міс | Крихкий компонент |
| NotebookLM | Free tier | $0 | Browser automation; rate limits |
| LLM (Claude API) | Pay-per-use | ~$0.01–$0.10 per run | Залежить від token usage |
| **Разом (мінімум)** | | **~$5–25/міс + LLM** | |

### Cost per agent run

```
Один run (середній):
  LLM calls (3 calls × ~2000 tokens): ~$0.03
  MinIO reads/writes: $0 (self-hosted)
  Orchestration Layer: $0 (self-hosted)
  NLM: $0 (browser automation)
  Worker execution: $0 (free tier)

Середня вартість run: ~$0.03–0.10
При 100 runs/day: ~$3–10/день → $90–300/міс (LLM only)
```

### Design points та cost ceilings

| Design Point | Est. monthly cost | Acceptable? |
|-------------|-------------------|------------|
| MVP (5–20 runs/day, 1–10 agents) | < $30/міс | ✅ Yes |
| V1 (50–200 runs/day, 10–50 agents) | $50–200/міс | ✅ Yes (LLM dominates) |
| Scale (1000 runs/day, 200 agents) | $300–1000/міс | ⚠️ Requires review |

**[ПРИНЦИП]** При переході через cost ceiling $100/міс — архітектурний review обов'язковий.

### Cost optimization levers

| Важіль | Механізм | Ефект |
|--------|---------|-------|
| LLM model selection | Використовувати cheaper model для routine runs | -50–80% LLM cost |
| Agent execution frequency | Cron schedule замість on-demand | Контрольоване використання |
| Memory layer efficiency | Aggressive eviction Layer 1 | Зменшення token cost per run |
| NLM call frequency | Cache NLM responses per session | -30–50% NLM calls |
| Cloudflare Worker optimization | Batch small requests | Залишитись у free tier |

### Vendor risk та cost freedom

**[ПРИНЦИП]** Жоден компонент не має vendor lock-in, що призвів би до cost > $50/міс без альтернативи. Orchestration Layer є замінним (A4 aксіома). LLM є замінним (будь-який OpenAI-compatible provider).

---

## ІНВАРІАНТИ

**COST-INV-001:** Вибір нового vendor (LLM, orchestration, hosting) вимагає cost estimate відносно поточного baseline. Рішення, що збільшують monthly cost > 2× без explicit architectural justification, вимагають Owner review.

**COST-INV-002:** NotebookLM (browser automation) є zero-cost but fragile component. Якщо Google вводить paid API — cost model потребує revision.

**COST-INV-003:** Self-hosted компоненти (MinIO, Hatchet) мають hidden cost (ops time). При збільшенні ops burden > 2 год/тиж — managed альтернатива розглядається.

---

## ЗВ'ЯЗКИ

**Цей документ залежить від:**
- [[АРХІТЕКТУРНИЙ_КОРІНЬ]] — A4 (replaceable orchestration), component roles
- [[АРХІТЕКТУРНА_БАЗА_СИСТЕМИ]] — §9 Infrastructure cost baseline (historical snapshot)
- [[МОДЕЛЬ_МАСШТАБУВАННЯ]] — cost at different design points

**Цей документ впливає на:**
- Architectural decisions про вибір vendor components
- [[СТРАТЕГІЯ_ПРОДУКТУ]] → бізнес-модель та pricing

---

*Цей документ визначає cost model для Garden Bloom: self-hosted first, pay-per-use LLM, vendor-agnostic.*
