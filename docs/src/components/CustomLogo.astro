---
import darkLogoSvg from '../assets/agentic-workflow.svg?raw';
import lightLogoSvg from '../assets/agentic-workflow-light.svg?raw';

const { siteTitleHref } = Astro.props;

const homeUrl = siteTitleHref || import.meta.env.BASE_URL || '/';
const darkLogoUrl = `data:image/svg+xml;base64,${Buffer.from(darkLogoSvg).toString('base64')}`;
const lightLogoUrl = `data:image/svg+xml;base64,${Buffer.from(lightLogoSvg).toString('base64')}`;
const initialLogoUrl = darkLogoUrl;
---

<a href={homeUrl} class="site-title">
	<img src={initialLogoUrl} alt="GitHub Agentic Workflows" class="theme-logo" data-dark-src={darkLogoUrl} data-light-src={lightLogoUrl} />
	<span>GitHub Agentic Workflows</span>
</a>

<script is:inline define:vars={{ darkLogoUrl, lightLogoUrl }}>
  (function() {
    const theme = document.documentElement.getAttribute('data-theme');
    const img = document.querySelector('.theme-logo');
    if (img && theme === 'light') {
      img.src = lightLogoUrl;
    } else if (img) {
      img.src = darkLogoUrl;
    }
  })();
</script>

<style>
  .theme-logo {
    transition: none !important;
    display: block;
    flex-shrink: 0;
  }
</style>

<script>
  const updateLogo = () => {
    const theme = document.documentElement.getAttribute('data-theme');
    const img = document.querySelector('.theme-logo') as HTMLImageElement;
    
    if (img) {
      const darkSrc = img.getAttribute('data-dark-src');
      const lightSrc = img.getAttribute('data-light-src');
      
      if (theme === 'light' && lightSrc) {
        img.src = lightSrc;
      } else if (darkSrc) {
        img.src = darkSrc;
      }
    }
  };

  const observer = new MutationObserver(updateLogo);
  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ['data-theme']
  });
</script>
