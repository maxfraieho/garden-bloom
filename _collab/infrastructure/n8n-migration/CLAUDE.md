<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Feb 2, 2026 - n8n Migration Deployment Session

**Session ID:** #S40-S41 (deployment-agent)

**Phase Progress:**
- Phase 0: Discovery - COMPLETE
- Phase 1: MCP Connection - COMPLETE (read-only access confirmed)
- Phase 2: Zones Management - IN PROGRESS (workflows created, pending Redis config)
- Phase 3: Storage (MinIO) - PENDING
- Phase 4: NotebookLM - PENDING
- Phase 5: Verification - PENDING

**Created Workflows:**
| Name | ID | Status |
|------|-----|--------|
| Garden - Zones Create | `HgdX7OIRzOHPz473` | Inactive |
| Garden - Zones Delete | `xDXU1njw8g9b6ba0` | Inactive |

**n8n Access:**
- MCP URL: `https://n8n.exodus.pp.ua/mcp-server/http`
- REST API: `https://n8n.exodus.pp.ua/api/v1/`
- API Key Header: `X-N8N-API-KEY`

**Key Discoveries:**
1. MCP provides read/execute only - no workflow creation
2. REST API requires separate API key (not MCP token)
3. Must use file-based curl for large JSON payloads
4. Redis credentials must be configured manually in n8n UI

**Blockers:**
- Redis not configured in n8n - workflows cannot be activated

**Next Steps:**
1. User configures Redis in n8n (see workflows/README.md)
2. Assign Redis credentials to workflow nodes
3. Activate workflows
4. Continue to Phase 3 (MinIO)
</claude-mem-context>

# n8n Migration - Claude Code Context

## Source of Truth

**API_MAP.md** - Complete reference for all 28 endpoints

## Deployment Protocol

1. **No secrets in webhook bodies** - use n8n credentials/env vars
2. **Phase-by-phase execution** - no skipping ahead
3. **Verification required** - before marking phase complete
4. **Mask keys in reports** - never expose credentials

## n8n API Access

```bash
# List workflows
curl -s "https://n8n.exodus.pp.ua/api/v1/workflows" \
  -H "X-N8N-API-KEY: <key>" | jq '.data[] | {id, name, active}'

# Get workflow details
curl -s "https://n8n.exodus.pp.ua/api/v1/workflows/<id>" \
  -H "X-N8N-API-KEY: <key>"

# Create workflow (use file for JSON)
curl -X POST "https://n8n.exodus.pp.ua/api/v1/workflows" \
  -H "X-N8N-API-KEY: <key>" \
  -H "Content-Type: application/json" \
  -d @/tmp/workflow.json

# Activate workflow
curl -X PATCH "https://n8n.exodus.pp.ua/api/v1/workflows/<id>" \
  -H "X-N8N-API-KEY: <key>" \
  -H "Content-Type: application/json" \
  -d '{"active": true}'
```

## Endpoint Classification

**Node.js Adapter Only:**
- `/health`, `/auth/*`, CORS preflight
- `/mcp` (stateful JSON-RPC)
- `/sse` (streaming)
- GET endpoints (zones/validate, zones/list, zones/notes, comments)

**n8n Workflows Required:**
- `POST /zones/create` → zones-create workflow
- `DELETE /zones/:zoneId` → zones-delete workflow
- `POST /sessions/create` → sessions-create workflow
- NotebookLM operations

## Redis Key Schema

```
zone:<zoneId>           # Zone object with TTL
zones:index             # Array of zone IDs
session:<sessionId>     # MCP session data
auth:password           # Hashed password
auth:initialized        # Boolean flag
comment:<commentId>     # Comment object
comments:<articleSlug>  # Array of comment IDs
```
