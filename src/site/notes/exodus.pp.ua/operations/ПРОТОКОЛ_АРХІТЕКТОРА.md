---
{"tags":["domain:meta","status:canonical","format:guide"],"created":"2026-02-22","updated":"2026-02-22","tier":2,"title":"ПРОТОКОЛ АРХІТЕКТОРА","dg-publish":true,"dg-metatags":null,"dg-home":null,"permalink":"/exodus.pp.ua/operations/ПРОТОКОЛ_АРХІТЕКТОРА/","dgPassFrontmatter":true,"noteIcon":""}
---


# ПРОТОКОЛ_АРХІТЕКТОРА

> Створено: 2026-02-22
> Автор: Головний архітектор системи
> Статус: Канонічний операційний протокол
> Мова: Українська (канонічна)

---

## 0. Призначення

Цей документ є **операційним протоколом для архітектора** (людини або Claude Opus Agent) при роботі з knowledge graph docs/. Він відповідає на питання:

- Як правильно додати новий документ у канон?
- Як закривати orphan/weakly-connected вузли?
- Як підтримувати граф структурованим без деградації?

Canonical enforcement rules — в [[exodus.pp.ua/architecture/governance/ІНВАРІАНТИ_ГРАФУ_ЗНАНЬ\|ІНВАРІАНТИ_ГРАФУ_ЗНАНЬ]].
Структура шарів — у [[exodus.pp.ua/КАРТА_СИСТЕМИ\|КАРТА_СИСТЕМИ]].

---

## 1. Як інтегрувати новий документ у канон (5 кроків)

```
Крок 1: Визнач шар
  → foundation/ : аксіоматичний документ, змінює A1–A7? Дуже рідко.
  → core/       : runtime spec? Описує "як система виконує"?
  → features/   : конкретна підсистема? ADR?
  → non-functional/ : SLO, security, reliability?
  → governance/ : процес, правило, інваріант?
  → operations/ : витяг для конкретної аудиторії?
  → Tier 2 у відповідній папці (drakon/, frontend/, backend/, product/)

Крок 2: Обери tier
  → tier: 1 : canonical spec, авторитетне джерело правди
  → tier: 2 : supporting, operational extract, guide

Крок 3: Додай мінімальну frontmatter секцію
  ---
  tags:
    - domain:arch|meta|product|drakon|frontend|backend
    - status:canonical|draft|historical
    - format:spec|guide|inventory|philosophy
  tier: 1 або 2
  title: "НАЗВА ДОКУМЕНТА"
  dg-publish: true
  dg-metatags:
  dg-home:
  ---

Крок 4: Додай "## Семантичні зв'язки" в кінці файлу
  Мінімум:
    - 1 "Цей документ є частиною:" → [[батьківський вузол]]
    - 2 "Цей документ залежить від:" → [[deps...]]
    - (опціонально) "Від цього документа залежать:"

Крок 5: Додай inbound link
  → у батьківський canonical doc: "Деталізується у [[НОВИЙ_ДОКУМЕНТ]]"
  → або у КАРТА_ГРАФУ (якщо Tier 1)
  → або у КАРТА_СИСТЕМИ (якщо operations)
  → або у ІНДЕКС (якщо треба NotebookLM visibility)
```

**Перевірка:** `python3 scripts/enforce-frontmatter.py` та `python3 scripts/check-graph.py` (якщо є) мають повертати exit 0.

---

## 2. П'ятихвилинний цикл підтримки графу

Запускай щоразу перед commit нових docs/:

```bash
# 1. Перевір frontmatter (30 сек)
python3 scripts/enforce-frontmatter.py --ci

# 2. Знайди нові orphans (30 сек)
python3 -c "
from pathlib import Path; import re
DOCS = Path('docs'); SKIP = {'_quarantine', 'CLAUDE.md'}
files = {p.stem.lower(): p for p in DOCS.rglob('*.md')
         if not any(s in str(p) for s in SKIP)}
inlinks = {s: 0 for s in files}
for p in files.values():
    t = p.read_text(encoding='utf-8', errors='replace')
    for lk in re.findall(r'\[\[([^\]|#]+?)\]\]', t):
        if lk.lower() in inlinks and lk.lower() != p.stem.lower():
            inlinks[lk.lower()] += 1
orphans = [(s, str(files[s].relative_to(DOCS))) for s, c in inlinks.items()
           if c == 0 and 'isolated: intentional' not in files[s].read_text()]
for stem, path in orphans: print(f'ORPHAN: {path}')
if not orphans: print('OK: no orphans')
"

# 3. Якщо orphans знайдені → fix за кроками §1
```

**Якщо orphan знайдено:**
1. Чи документ навмисно ізольований? → додай `isolated: intentional` у frontmatter + пояснення у "## Семантичні зв'язки"
2. Якщо ні → знайди семантичного батька → додай `[[НОВИЙ_ДОКУМЕНТ]]` у батьківський вузол

---

## 3. Шаблон секції "## Семантичні зв'язки"

```markdown
---

## Семантичні зв'язки

**Цей документ є частиною:**
- [[БАТЬКІВСЬКИЙ_ВУЗОЛ]] — одне речення про відношення

**Цей документ залежить від:**
- [[DEP_1]] — чому залежить
- [[DEP_2]] — чому залежить

**Від цього документа залежать:**
- [[CHILD_1]] — який документ деталізує цей
- (або: Lovable Frontend, graph-linter тощо, якщо немає doc-рефа)

---

*Одне речення про призначення цього документа.*
```

**Правила:**
- "Батько" — 1 документ (не більше 2). Він є canonical parent.
- "Залежить від" — 2–5 посилань. Тільки причинно-наслідкові зв'язки.
- "Від цього залежать" — 0–5. Може бути порожнім.
- НЕ додавай посилання заради "повноти". Кожне посилання має логічне обґрунтування.

---

## 4. Правила для шарів

### Foundation (architecture/foundation/)
- Тут живуть аксіоми. Нових документів майже не буває.
- Новий документ сюди → обговорення з Owner, бо змінює архітектурний фундамент.
- Батько для всього тут: не існує (це корінь). Залежить від: [[exodus.pp.ua/manifesto/МАНІФЕСТ\|МАНІФЕСТ]].

### Core (architecture/core/)
- Runtime specs. Один документ = одна runtime-концепція.
- Кожен новий doc тут → обов'язково у КАРТА_ГРАФУ Tier 1 + посилання з АРХІТЕКТУРНИЙ_КОРІНЬ §6.
- Батько: [[exodus.pp.ua/architecture/foundation/АРХІТЕКТУРНИЙ_КОРІНЬ\|АРХІТЕКТУРНИЙ_КОРІНЬ]] або існуючий core doc.

### Features (architecture/features/)
- Підсистеми та ADRs. Нова feature → Tier 1 або Tier 2.
- Новий ADR: `ADR_НАЗВА.md`, tier:2, посилання з відповідного core doc.
- Батько: відповідний core doc або [[exodus.pp.ua/architecture/foundation/АРХІТЕКТУРНИЙ_КОРІНЬ\|АРХІТЕКТУРНИЙ_КОРІНЬ]].

### Non-Functional (architecture/non-functional/)
- По одному документу на NFR домен.
- Батько: [[exodus.pp.ua/architecture/foundation/АРХІТЕКТУРНИЙ_КОРІНЬ\|АРХІТЕКТУРНИЙ_КОРІНЬ]] або [[exodus.pp.ua/architecture/core/КАНОНІЧНА_АРХІТЕКТУРА_ВИКОНАННЯ\|КАНОНІЧНА_АРХІТЕКТУРА_ВИКОНАННЯ]].
- Кожен має посилання на [[exodus.pp.ua/architecture/non-functional/МОДЕЛЬ_МАСШТАБУВАННЯ\|МОДЕЛЬ_МАСШТАБУВАННЯ]] або суміжні NFR.

### Governance (architecture/governance/)
- Правила еволюції системи. Нові правила → через Proposal (інваріант I-S4).
- Батько: [[exodus.pp.ua/architecture/foundation/АРХІТЕКТУРНИЙ_КОРІНЬ\|АРХІТЕКТУРНИЙ_КОРІНЬ]] або [[exodus.pp.ua/architecture/governance/КАНОНІЧНИЙ_МЕТОД_МУЛЬТИАГЕНТНОЇ_РОЗРОБКИ\|КАНОНІЧНИЙ_МЕТОД_МУЛЬТИАГЕНТНОЇ_РОЗРОБКИ]].

### Operations (operations/)
- Витяги для конкретних аудиторій. Мають посилатись на canonical source.
- Батько: canonical doc, з якого витягнуто (напр., [[exodus.pp.ua/architecture/core/INBOX_ТА_PROPOSAL_АРХІТЕКТУРА\|INBOX_ТА_PROPOSAL_АРХІТЕКТУРА]]).
- Новий operations doc → додати рядок у КАРТА_СИСТЕМИ §2.7.

---

## 5. Як закрити orphan (алгоритм рішення)

```
Якщо document має 0 inlinks:

1. Чи це операційний промпт / tool / standalone? → isolated: intentional
   Додай до frontmatter: isolated: intentional
   Поясни в "Семантичні зв'язки": чому ізольовано.

2. Чи це historical/archive? → вже в historical/
   Додай "Семантичні зв'язки" з посиланням на canonical successor.
   Батьківський canonical doc → додати footnote: "Archived: [[ЦЕЙ_ДОКУМЕНТ]]"

3. Чи це Tier 2 operations/витяг? → знайди canonical source
   Canonical source → додай: "Деталізується у [[ЦЕЙ_ДОКУМЕНТ]]"

4. Чи це новий Tier 1 spec? → додай у КАРТА_ГРАФУ + ІНДЕКС + АРХІТЕКТУРНИЙ_КОРІНЬ §6

5. Якщо незрозуміло до якого шару → тимчасово в operations/ з TODO у frontmatter
   Додай тег: status:draft
   Через 1 тиждень → review + promote або archive
```

---

## 6. CI-перевірка (рекомендація)

Додай до `.github/workflows/docs-lint.yml`:

```yaml
name: docs-lint
on:
  push:
    paths: ['docs/**']
  pull_request:
    paths: ['docs/**']

jobs:
  frontmatter:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Check frontmatter
        run: python3 scripts/enforce-frontmatter.py --ci
        # Exit 1 якщо будь-який docs/*.md потребує змін

  graph-linter:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Check for orphan nodes
        run: python3 scripts/check-graph.py --ci
        # Exit 1 якщо orphans без isolated:intentional
```

**scripts/check-graph.py** (базова версія):

```python
#!/usr/bin/env python3
"""Graph integrity check: orphans, missing semantic links."""
import re, sys
from pathlib import Path

DOCS = Path(__file__).parent.parent / 'docs'
SKIP = {'_quarantine', 'CLAUDE.md'}

def is_excluded(p):
    return any(s in str(p) for s in SKIP)

files = {}
for p in DOCS.rglob('*.md'):
    if is_excluded(p): continue
    text = p.read_text(encoding='utf-8', errors='replace')
    stem = p.stem.lower()
    files[stem] = {
        'path': p, 'text': text,
        'is_isolated': 'isolated: intentional' in text,
        'has_sem': any(s in text for s in ["## Семантичні зв'язки", "## ЗВ'ЯЗКИ"]),
        'outlinks': re.findall(r'\[\[([^\]|#]+?)\]\]', text),
        'inlinks': 0,
    }

# Count inlinks
for stem, f in files.items():
    for link in f['outlinks']:
        t = link.lower()
        if t in files and t != stem:
            files[t]['inlinks'] += 1

errors = 0
for stem, f in files.items():
    rel = f['path'].relative_to(DOCS)
    if not f['is_isolated'] and f['inlinks'] == 0:
        print(f'ORPHAN: {rel}', file=sys.stderr)
        errors += 1
    if not f['has_sem'] and not f['is_isolated']:
        print(f'NO_SEMANTIC_LINKS: {rel}', file=sys.stderr)
        errors += 1

print(f'check-graph: {len(files)} files, {errors} violations')
sys.exit(1 if errors else 0)
```

---

## Семантичні зв'язки

**Цей документ є частиною:**
- [[exodus.pp.ua/КАРТА_СИСТЕМИ\|КАРТА_СИСТЕМИ]] — операційний протокол в рамках навігаційного центру

**Цей документ залежить від:**
- [[exodus.pp.ua/architecture/governance/ІНВАРІАНТИ_ГРАФУ_ЗНАНЬ\|ІНВАРІАНТИ_ГРАФУ_ЗНАНЬ]] — правила, які цей протокол операціоналізує
- [[exodus.pp.ua/architecture/foundation/АРХІТЕКТУРНИЙ_КОРІНЬ\|АРХІТЕКТУРНИЙ_КОРІНЬ]] — аксіоматична основа для прийняття рішень
- [[exodus.pp.ua/architecture/КАРТА_ГРАФУ\|КАРТА_ГРАФУ]] — реєстр вузлів для оновлення при нових документах

**Від цього документа залежать:**
- Архітектор системи (людина або Claude Opus Agent) — використовує як checklist
- [[exodus.pp.ua/architecture/governance/КАНОНІЧНИЙ_МЕТОД_МУЛЬТИАГЕНТНОЇ_РОЗРОБКИ\|КАНОНІЧНИЙ_МЕТОД_МУЛЬТИАГЕНТНОЇ_РОЗРОБКИ]] — цей протокол є його операційним виразом

---

*Цей документ є операційним протоколом архітектора для підтримки knowledge graph Gardens Bloom.*
