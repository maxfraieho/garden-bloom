---
{"title":"КАНОНІЧНА СИСТЕМА ТЕГУВАННЯ","dg-publish":true,"dg-metatags":null,"dg-home":null,"permalink":"/exodus.pp.ua/architecture/governance/КАНОНІЧНА_СИСТЕМА_ТЕГУВАННЯ/","dgPassFrontmatter":true,"noteIcon":""}
---


# Система тегування: Канонічна специфікація

> Створено: 2026-02-21
> Автор: Головний архітектор системи
> Статус: Canonical
> Мова: Українська (канонічна)

---

## 0. Призначення

Цей документ визначає **систему тегування** Garden Bloom — єдину узгоджену мову для класифікації документів, агентських артефактів та записів знань. Тегування слугує трьом цілям:

1. **Навігація**: людина знаходить документ за темою, не знаючи точної назви файлу
2. **Граф**: теги підсилюють (не замінюють) [[wiki-links]] — дають alternative point of entry
3. **Автоматизація**: агент `tag-auditor` перевіряє узгодженість тегів із семантичним графом та пропонує нормалізацію

**Теги — доповнення до wiki-links, а не замінник.** Якщо є можливість додати [[SomeDoc]], це краще ніж тег.

---

## 1. Таксономія (4 рівні)

### 1.1 Рівень `domain:` — архітектурний домен

Вказує, до якого кластера knowledge graph належить документ.

| Тег | Кластер | Приклад документів |
|-----|---------|---------------------|
| `domain:arch` | Architecture (Meta) | ARCHITECTURE_ROOT, RUNTIME_ARCHITECTURE_CANONICAL |
| `domain:agent` | Agent | КОНТРАКТ_АГЕНТА_V1, AGENT_MEMORY_GIT_DIFFMEM_V1 |
| `domain:execution` | Execution | EXECUTION_PIPELINE_CANONICAL, RUN_LIFECYCLE_CANONICAL |
| `domain:storage` | Storage | STORAGE_AUTHORITY_MODEL_CANONICAL |
| `domain:mutation` | Mutation/Proposal | INBOX_ТА_PROPOSAL_АРХІТЕКТУРА, PROPOSAL_SYSTEM_V1 |
| `domain:api` | API/Contracts | API_CONTRACTS_V1 |
| `domain:frontend` | Frontend | LOVABLE_УЗГОДЖЕННЯ, FRONTEND_ALIGNMENT_DIRECTIVE_V1 |
| `domain:security` | Security | БЕЗПЕКА_СИСТЕМИ |
| `domain:product` | Product | PRODUCT_STRATEGY, MANIFESTO |
| `domain:drakon` | DRAKON | DRAKON_ІНТЕГРАЦІЯ, DRAKONWIDGET_RESEARCH_UA |
| `domain:meta` | Docs infra | GRAPH_MAP, DOCUMENTATION_INVENTORY, LANGUAGE_CANONICALIZATION |

**Правило**: кожен документ має **рівно один** `domain:*` тег.

### 1.2 Рівень `status:` — статус документа

| Тег | Значення |
|-----|----------|
| `status:canonical` | Авторитетне джерело, Tier 1 |
| `status:historical` | Snapshot минулого стану, не оновлюється |
| `status:draft` | Ще не прийнятий як canonical |
| `status:deprecated` | Замінений іншим документом, на видалення |
| `status:quarantine` | В `_quarantine/`, не для використання |

**Правило**: кожен документ має **рівно один** `status:*` тег.

### 1.3 Рівень `format:` — тип артефакту

| Тег | Значення | Приклад |
|-----|----------|---------|
| `format:contract` | Binding spec між компонентами | КОНТРАКТ_АГЕНТА_V1, API_CONTRACTS_V1 |
| `format:spec` | Технічна специфікація | INBOX_ТА_PROPOSAL_АРХІТЕКТУРА |
| `format:guide` | Практичний посібник / інструкція | FRONTEND_V1_MIGRATION_PLAN |
| `format:audit` | Результати аудиту | АРХІТЕКТУРНИЙ_АУДИТ_FINAL |
| `format:philosophy` | Філософія та бачення | MANIFESTO, PHILOSOPHY_EVERYTHING_AGENT |
| `format:inventory` | Інвентаризація / каталог | DOCUMENTATION_INVENTORY, GRAPH_MAP |
| `format:prompt` | Операційний промпт | NOTEBOOKLM_AUDIO_PROMPT |
| `format:research` | Дослідницький матеріал | DRAKONWIDGET_RESEARCH_UA |

**Правило**: кожен документ має **рівно один** `format:*` тег.

### 1.4 Рівень `feature:` — системна фіча (опційний, max 2)

Уточнює, яку конкретну фічу системи описує документ. Використовується лише якщо `domain:*` недостатньо.

| Тег | Значення |
|-----|----------|
| `feature:proposal` | Proposal lifecycle, Inbox |
| `feature:storage` | MinIO, authority model |
| `feature:execution` | Run execution, pipeline |
| `feature:memory` | Agent memory, DiffMem |
| `feature:logic` | Agent logic, DRAKON, pseudocode |
| `feature:orchestration` | Hatchet, Orchestration Layer |
| `feature:auth` | Authentication, JWT, zones |
| `feature:tagging` | Tag system |
| `feature:graph` | Knowledge graph |

**Правило**: `feature:*` — опційний, максимум 2 теги на документ.

---

## 2. Правила іменування

- **Формат**: `level:value` — завжди дві частини через двокрапку
- **Реєстр**: `lowercase-kebab-case` для обох частин
- **Мова**: **тільки англійська** (технічні ідентифікатори — виняток з мовної норми UA)
- **Без пробілів**: `domain:arch`, не `domain: arch`, не `domain:Arch`
- **Без вільного тексту**: `feature:proposal`, не `feature:proposal-lifecycle-inbox-system`

**Заборонені патерни:**

| Антипатерн | Правильно |
|-----------|-----------|
| `architectural` | `domain:arch` |
| `agent-definition` | `domain:agent` + `format:contract` |
| `important` | — (не несе значення) |
| `TODO` | — (статус робиться через `status:draft`) |
| `Ukrainian` | — (мовна норма — через `LANGUAGE_CANONICALIZATION`) |

---

## 3. Ліміти

| Параметр | Ліміт |
|----------|-------|
| Теги на документ | **мінімум 3, максимум 5** (завжди: 1 domain + 1 status + 1 format + до 2 feature) |
| Загальна кількість тегів у системі | **≤ 40** (entropy budget) |
| Нових тегів за квартал (без proposal) | **0** (будь-який новий тег → proposal) |

Якщо `total_tags > 40`, перед додаванням нового тегу — обов'язкова консолідація (merge двох існуючих або deprecation).

---

## 4. Frontmatter

Теги зберігаються у YAML frontmatter на початку Markdown-файлу:

```yaml
---
tags:
  - domain:arch
  - status:canonical
  - format:spec
  - feature:proposal
created: 2026-02-21
updated: 2026-02-21
tier: 1
---
```

**Обов'язкові поля frontmatter**:
- `tags` — масив тегів (3–5 елементів)
- `created` — дата створення (ISO 8601)
- `updated` — дата останньої зміни

**Опційні**:
- `tier` — 1 або 2 (для docs/ документів)
- `aliases` — список альтернативних назв для пошуку

---

## 5. Canonical Tag Set (core tagset)

Повний список затверджених тегів:

```yaml
# TAG_TAXONOMY.yaml — машинно-читабельна версія
# Canonical version: docs/architecture/КАНОНІЧНА_СИСТЕМА_ТЕГУВАННЯ.md

domain:
  - arch
  - agent
  - execution
  - storage
  - mutation
  - api
  - frontend
  - security
  - product
  - drakon
  - meta

status:
  - canonical
  - historical
  - draft
  - deprecated
  - quarantine

format:
  - contract
  - spec
  - guide
  - audit
  - philosophy
  - inventory
  - prompt
  - research

feature:
  - proposal
  - storage
  - execution
  - memory
  - logic
  - orchestration
  - auth
  - tagging
  - graph
```

---

## 6. Антипатерни

### 6.1 Tag drift

**Симптом**: з'являються теги, що не існують у taxonomy: `architecture`, `proposal-system`, `backend`, `v1`.

**Причина**: редактор додає теги без перевірки по canonical set.

**Запобігання**: `tag-auditor` агент ловить drift при кожному commit та створює proposal нормалізації. Людина approves.

### 6.2 Tag explosion

**Симптом**: 70+ тегів у системі, більшість використовуються 1–2 рази.

**Причина**: кожен документ отримує власну мікро-класифікацію.

**Запобігання**: entropy budget ≤ 40. `tag-auditor` сигналізує при перевищенні.

### 6.3 Tag ↔ graph inconsistency

**Симптом**: документ позначений `feature:proposal`, але не має [[INBOX_ТА_PROPOSAL_АРХІТЕКТУРА]] у "Семантичні зв'язки".

**Причина**: теги додані вручну без узгодження з wiki-links.

**Запобігання**: `tag-auditor` перевіряє відповідність `feature:*` тегів до наявних wiki-links. Якщо тег є, а посилання — ні, створює `propose-tag-link-fix`.

### 6.4 Orphan tags

**Симптом**: документ має теги, але нуль wiki-links.

**Причина**: автор думав, що теги замінюють посилання.

**Запобігання**: теги ≠ посилання. `graph-linter` ловить orphan nodes незалежно від наявності тегів.

---

## 7. Governance: додавання та зміна тегів

### 7.1 Новий тег

1. Автор бачить потребу в новому тегу
2. Пише proposal (через Inbox або вручну): `propose-new-tag` із обгрунтуванням
3. Owner перевіряє:
   - Чи не покривається існуючим тегом?
   - Чи буде використовуватись ≥ 3 документами?
   - Чи вписується у 4-рівневу таксономію?
4. При схваленні: тег додається до `TAG_TAXONOMY.yaml` + до цього документу
5. `tag-auditor` на наступному run починає перевіряти відповідність

### 7.2 Deprecation тегу

1. `tag-auditor` виявляє тег із частотою < 2 або що дублює інший тег → `propose-tag-deprecate`
2. Owner approve → тег отримує `deprecated:` prefix у taxonomy
3. Через 60 днів: `tag-auditor` пропонує масову заміну deprecated тегів на canonical alias
4. Після заміни: тег видаляється з taxonomy

### 7.3 Alias mapping

У `TAG_TAXONOMY.yaml` визначені aliases:

```yaml
aliases:
  - from: proposal-system
    to: feature:proposal
  - from: storage-layer
    to: domain:storage
  - from: backend
    to: domain:api
```

`tag-auditor` застосовує alias mapping автоматично через proposal (не force-push).

---

## 8. Інтеграція з knowledge graph

### 8.1 Тег → wiki-link очікування

| Тег | Очікуване wiki-link |
|-----|---------------------|
| `feature:proposal` | [[INBOX_ТА_PROPOSAL_АРХІТЕКТУРА]] |
| `feature:storage` | [[КАНОНІЧНА_МОДЕЛЬ_АВТОРИТЕТУ_СХОВИЩА]] |
| `feature:execution` | [[КАНОНІЧНИЙ_КОНВЕЄР_ВИКОНАННЯ]] |
| `feature:memory` | [[ПАМ_ЯТЬ_АГЕНТА_GIT_DIFFMEM_V1]] |
| `feature:logic` | [[DRAKON_ІНТЕГРАЦІЯ_ТА_МОДЕЛЬ_ВИКОНАННЯ_АГЕНТА]] |
| `feature:orchestration` | [[АБСТРАКЦІЯ_РІВНЯ_ОРКЕСТРАЦІЇ]] |
| `feature:auth` | [[БЕЗПЕКА_СИСТЕМИ]] |
| `feature:graph` | [[КАРТА_ГРАФУ]] |

`tag-auditor` перевіряє: якщо `feature:X` присутній, відповідний wiki-link має бути в "Семантичні зв'язки".

### 8.2 graph.json та теги

Агент `graph-linter` при побудові `index/graph.json` включає теги кожного вузла:

```json
{
  "ARCHITECTURE_ROOT": {
    "file": "docs/architecture/АРХІТЕКТУРНИЙ_КОРІНЬ.md",
    "tags": ["domain:arch", "status:canonical", "format:spec"],
    "outlinks": ["STORAGE_AUTHORITY_MODEL_CANONICAL", "..."],
    "inlinks": ["GRAPH_MAP", "INDEX"],
    "tier": 1
  }
}
```

Це дозволяє фільтрувати граф за тегами без окремої БД.

---

## 9. Proposal-based tag QA

`tag-auditor` генерує proposals стандартного типу:

| Тип proposal | Тригер | Confidence |
|-------------|--------|-----------|
| `propose-tag-normalize` | Тег не в taxonomy | HIGH (auto-approve після 24h) |
| `propose-tag-link-fix` | `feature:X` є, wiki-link — ні | MEDIUM |
| `propose-tag-deprecate` | Тег freq < 2 або дубль | LOW (human review) |
| `propose-new-tag` | Автор запропонував новий тег | LOW (human review) |
| `propose-entropy-consolidation` | total_tags > 40 | CRITICAL (блокує нові теги) |

---

## Семантичні зв'язки

**Цей документ деталізує:**
- [[АРХІТЕКТУРНИЙ_КОРІНЬ]] — операційна норма для системи знань (мовна + структурна)

**Цей документ залежить від:**
- [[КАНОНІЗАЦІЯ_МОВИ]] — тег-ідентифікатори є винятком EN у UA-документах
- [[КАРТА_ГРАФУ]] — кластери knowledge graph відображаються у `domain:*` тегах
- [[INBOX_ТА_PROPOSAL_АРХІТЕКТУРА]] — governance через proposal lifecycle

**Від цього документа залежать:**
- [[ІНВАРІАНТИ_ГРАФУ_ЗНАНЬ]] — інваріанти включають правила тегування
- `agents/tag-auditor/_agent.md` — агент читає цей документ як knowledge source

---

*Цей документ є канонічною специфікацією системи тегування Garden Bloom.*
